# Домашнее задание №1. Linux & Tmux.

-   **Мягкий deadline:** 16.10, 23:59.
-   **Жёсткий deadline:** 23.10, 23:59.

**Основная идея:** программа должна уметь запускать параллельно несколько изолированных окружений Jupyter Notebook (далее окружений) с помощью *tmux* и останавливать их.

## Подробное описание

1. Реализуемая программа должна быть консольной - запускаться и принимать аргументы из командной строки
2. Программа должна выполнять следующие функции:
	- **Запустить N новых окружений.** Запуск должен осуществляться в виде:
		`python3 main.py start N`
		где N - кол-во окружений, которые хоти запустить. В результате чего должна быть создана сессия с N окнами, в каждом из которых запущено и работает без ошибок окружение. На этапе проверки количество запускаемых сессий не будет превышать 10, но в коде оно не должно быть ограничено. 
		
		Также в результате работы этой команды должна быть выведена информация о каждом из запущенных окружений - их порядковый номер, порт и токен. Кроме того, в процессе создания окружений должен быть progress bar.
		
	- **Остановить i-е окружение.** Остановка должна осуществляться в виде:
		`python3 main.py stop 0`
		где 0 - id ноутбука, который хотим остановить
		
	- **Остановить все окружения.** Полная остановка должна осуществляться в виде:
		`python3 main.py stop_all`
3. Изолированность окружений означает:
	- для базового потока - каждый Jupyter Notebook запускается **в отдельном tmux-окне**, **в отдельной директории**, **на отдельном сетевом порту** и **с отдельным (уникальным и случайным) токеном**.
	- для продвинутого потока - дополнительно, каждый Jupyter Notebook должен жить **в своем виртуальном окружении Python (venv), создаваемом в отдельных папках** - см. подробнее [оф. документацию](https://docs.python.org/3/library/venv.html) и [туториал](https://firstvds.ru/technology/ustanovka-python-39-i-virtualnogo-okruzheniya-venv#venv).

## Полезные материалы

- `libtmux` - библиотека для работы с tmux
- `argparse` - библиотека для парсинга аргументов командной строки
- `click` - альтернативная `argparse`
- `tqdm` - библиотека для progress bar
- команда для запуска Jupyter Notebok
	  `jupyter notebook --ip {} --port {} --no-browser --NotebookApp.token='{}' --NotebookApp.notebook_dir='{}'`

## Критерии оценивания

1. **[2]** Программа должна уметь стартовать и убивать окружения с помощью команд:
		- **[1]** стартовать окружения с помощью `python3 main.py start N`
		- **[0.5]** убивать одно конкретное окружение с помощью `python3 main.py stop`
		- **[0.5]** убивать все окружения с помощью `python3 main.py stop_all`
2. **[1]** Каждое созданное окружение должно жить в своем tmux-окне (window).
3. **[0.5]** При старте окружений должен выводиться progress bar. 
4. **[1.5]** У каждого окружения должны быть:
		- **[0.5]** отдельная рабочая директория + (для прод.) отдельное виртуальное venv окружение
		- **[0.5]** отдельный сетевой порт
		- **[0.5]** отдельный (уникальный и случайный) токен.

## Формат сдачи

1. Выполняете задание
2. Загружаете выполненное задание с помощью git (не веб-интерфейса!) на [gitlab.atp-fivt.org](gitlab.atp-fivt.org) в свой репозиторий по заданию 1 (репозиторий вида login-hw1) **в ветку hw1task1**
3. Создаете merge request из ветки hw1task1 в ветку main - **не выставляйте** при этом assignee и прочие позиции!
4. Проверяете, что в [табличке](https://docs.google.com/spreadsheets/d/e/2PACX-1vR_OrLG0mVr60HdTELL0Tjv41FFYzvI4zAU06cDQZEAu4NjRapMu0OJe8W-0t9CX5uUZnbE-BrATgdc/pubhtml?gid=0&single=true) в столбце *Queue* появилась ссылка на ваш репозиторий. **Внимание** - табличка обновляется раз в 5 минут, ваш репозиторий может появиться не сразу!
5. Ждете, пока ваше задание проверят.
6. Если проверяющий не обнаружит проблем в вашем решении, то он выставляет баллы по вашему заданию и выполняет слияние веток. Если проверяющий обнаружил проблемы в вашем решении, то он указывает их в комментарии к решению (вы получите уведомление на почту о новом комментарии к вашему MR). После чего вы вносите исправления и снова загружаете их в репозиторий в ту же ветку **hw1task1**. Так продолжается, пока проверяющий не согласится принять ваше задание.


## Примерный интерфейс для реализации

Это лишь предлагаемый небольшой шаблон, вам нужно его дополнить либо переделать под себя:

```python
import libtmux
import os
import tqdm


def start(num_users, base_dir='./'):
    """
    Запустить $num_users ноутбуков. У каждого рабочай директория $base_dir+$folder_num
    """
    pass
    

def stop(session_name, num):
    """
    @:param session_name: Названия tmux-сессии, в которой запущены окружения
    @:param num: номер окружения, кот. можно убить
    """
    pass


def stop_all(session_name):
    """
    @:param session_name: Названия tmux-сессии, в которой запущены окружения
    """
    pass
```
